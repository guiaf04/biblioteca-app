#!/bin/bash

# Script de monitoramento da aplicaÃ§Ã£o Biblioteca

log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $1"
}

log "ğŸ“Š Status da aplicaÃ§Ã£o Biblioteca:"
echo ""

# Status dos containers
echo "ğŸ³ Containers:"
docker-compose -f {{ app_directory }}/docker-compose.yml ps

echo ""

# Uso de recursos
echo "ğŸ’» Uso de recursos:"
echo "CPU: $(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)%"
echo "MemÃ³ria: $(free -h | awk 'NR==2{printf "%.1f%%", $3*100/$2}')"
echo "Disco: $(df -h / | awk 'NR==2{print $5}')"

echo ""

# Logs recentes
echo "ğŸ“ Logs recentes do backend:"
docker-compose -f {{ app_directory }}/docker-compose.yml logs --tail=5 backend

echo ""
echo "ğŸ“ Logs recentes do frontend:"
docker-compose -f {{ app_directory }}/docker-compose.yml logs --tail=5 frontend


